<!DOCTYPE html><html>
<meta charset="utf-8" />
<head>
	<script src="https://unpkg.com/leaflet@1.0.2/dist/leaflet.js"></script>
	<link rel="stylesheet" href="https://unpkg.com/leaflet@1.0.2/dist/leaflet.css" />

 <style>
  #map { 
 height: 600px; }
 </style>
 
 </head>
  <body>
   <div id="map"></div>
 <script>
 
var map = L.map('map').
setView([41.3870154, 2.1700471], 
16);

var popup = L.popup();

function onMapClick(e) {
  popup
    .setLatLng(e.latlng)
    .setContent("Mis coordenadas son: " + e.latlng.toString())
    .openOn(map);

marker = new L.marker(e.latlng, {id:uni, icon:redIcon});     
L.marker([e.latlng]).addTo(map);
marker.setLatLng(position,{id:uni}).bindPopup(position).update();
}
map.on('click', onMapClick);
/*function onMapClick(e) {
gib_uni();
marker = new L.marker(e.latlng, {id:uni, icon:redIcon});
marker.on("dragend", function(event){
var marker = event.target;
var position = marker.getLatLng();
console.log(position);
marker.setLatLng(position,{id:uni}).bindPopup(position).update();
});
map.addLayer(marker);
};*/

L.tileLayer('http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="http://cloudmade.com">CloudMade</a>',
    maxZoom: 17
}).addTo(map);

</script>
 </body> 
 </html>